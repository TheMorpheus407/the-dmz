{"assignees":[],"author":{"id":"MDQ6VXNlcjIyODUzMjIy","is_bot":false,"login":"TheMorpheus407","name":"The Morpheus Tutorials"},"body":"## Summary\nImplement Zod-based validation schemas in the shared package that compile to JSON Schema for Fastify route validation. This establishes a single source of truth for request/response validation across frontend and backend.\n\n## Requirements\n\n### Zod Schema Architecture\n- Zod schemas defined in `packages/shared` as the canonical validation source\n- `zod-to-json-schema` for Fastify JSON Schema integration\n- Frontend uses Zod directly for form validation\n- Backend uses compiled JSON Schema for Fastify route schemas\n\n### Initial Schemas\n```typescript\n// packages/shared/src/schemas/\nschemas/\n  auth.schema.ts      # Login, register, token refresh\n  common.schema.ts    # Pagination, sort, date range queries\n  health.schema.ts    # Health check response\n  index.ts            # Barrel export + JSON Schema compilation\n```\n\n### Auth Schemas (initial)\n```typescript\nexport const loginSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(8).max(128),\n});\n\nexport const registerSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(12).max(128),\n  displayName: z.string().min(2).max(64),\n});\n\nexport const paginationSchema = z.object({\n  page: z.coerce.number().int().positive().default(1),\n  limit: z.coerce.number().int().min(1).max(100).default(20),\n  sortBy: z.string().optional(),\n  sortOrder: z.enum(['asc', 'desc']).default('desc'),\n});\n```\n\n### JSON Schema Compilation\n- Utility function to convert Zod schemas to JSON Schema\n- Pre-compiled JSON Schemas exported for Fastify consumption\n- Type inference from Zod schemas (`z.infer<typeof schema>`)\n\n### Integration Pattern\n```typescript\n// In Fastify routes:\nimport { loginJsonSchema } from '@the-dmz/shared/schemas';\n\nfastify.post('/auth/login', {\n  schema: {\n    body: loginJsonSchema,\n  },\n  handler: loginHandler,\n});\n```\n\n## Acceptance Criteria\n- [ ] Zod schemas compile to valid JSON Schema\n- [ ] Fastify validates requests using compiled schemas\n- [ ] Frontend can use same Zod schemas for form validation\n- [ ] TypeScript types are inferred from schemas (`z.infer`)\n- [ ] Invalid requests return structured error responses with field-level details\n- [ ] Schema compilation happens at build time, not runtime\n\n## References\n- MILESTONES.md: M0 \"Shared validation\" deliverable\n- DD-09 Section 3: API Design (schema validation)\n- DD-08 Section 15: API Integration Layer\n\n## Dependencies\n- M0-04: Create shared TypeScript packages\n- M0-03: Scaffold Fastify backend application\n\n---","comments":[],"createdAt":"2026-02-05T15:21:34Z","labels":[{"id":"LA_kwDOQ_FFzs8AAAACXIw6vQ","name":"M0: Bootstrap","description":"Milestone 0: Project Bootstrap","color":"1D76DB"},{"id":"LA_kwDOQ_FFzs8AAAACXIw7OA","name":"backend","description":"Backend (Fastify)","color":"E8560C"},{"id":"LA_kwDOQ_FFzs8AAAACXIw9PA","name":"shared","description":"Shared packages & types","color":"BFD4F2"}],"number":5,"title":"M0-05: Set up Zod shared validation schemas","updatedAt":"2026-02-05T15:21:34Z","url":"https://github.com/TheMorpheus407/the-dmz/issues/5"}
